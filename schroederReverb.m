function [output] = schroederReverb( ...
  inputSignal, ...
  Fs, ...
  combDelayMatrix, ...
  combType, ...
  allPassDelayMatrix, ...
  feedfowardCoefficient, ...
  feedbackCoefficient ...
)
  signalSize = length(inputSignal);
  [numCombs channels] = size(combDelayMatrix);
  [numAllPass unusedVariable] = size(allPassDelayMatrix);
  maxDelay = max(combDelayMatrix);

  filteredSignals = [];
  for i = 1 : numCombs
      switch combType
          case 'IIR'
              filterOutput = IIR( ...
                  inputSignal, ...
                  feedfowardCoefficient, ...
                  feedbackCoefficient, ...
                  combDelayMatrix(i,1), ...
                  maxDelay ...
              );
          case 'FIR'
              filterOutput = FIR( ...
                  inputSignal, ...
                  feedfowardCoefficient, ...
                  feedbackCoefficient, ...
                  combDelayMatrix(i,1), ...
                  maxDelay ...
              );
          otherwise
              error('Unknown filtertype');
      end

      filteredSignals = [filteredSignals filterOutput];
  end

  filterOutput = combineSignals(filteredSignals);
  hidelay = max(allPassDelayMatrix);
  
  for j = 1 : numAllPass
      c = allPassDelayMatrix(j, 1);
      filterOutput = allPass(filterOutput, c);
  end

  output = filterOutput;
end